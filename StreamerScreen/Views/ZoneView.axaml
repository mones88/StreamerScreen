<UserControl xmlns="https://github.com/avaloniaui"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             xmlns:vm="using:StreamerScreen.ViewModels"
             mc:Ignorable="d" d:DesignWidth="800" d:DesignHeight="450"
             x:Class="StreamerScreen.Views.ZoneView"
             x:DataType="vm:ZoneViewModel"
             Background="#1F1F1F">
    
    <Design.DataContext>
        <vm:ZoneViewModelDesign />
    </Design.DataContext>

    <UserControl.Resources>
        <Animation
            x:Key="TrackAnimation"
            x:SetterTargetType="ScrollViewer"
            Duration="0:0:15" IterationCount="1">
            <KeyFrame Cue="0%">
                <Setter Property="Offset" Value="0,0"></Setter>
            </KeyFrame>
            <KeyFrame Cue="100%">
                <Setter Property="Offset" Value="300,0"></Setter>
            </KeyFrame>
        </Animation>
    </UserControl.Resources>

    <UserControl.Styles>
        <!--<Style Selector="ScrollViewer">
            <Style.Animations>
                <Animation
                    Duration="0:0:2" IterationCount="1">
                    <KeyFrame Cue="0%">
                        <Setter Property="Opacity" Value="1"></Setter>
                    </KeyFrame>
                    <KeyFrame Cue="50%">
                        <Setter Property="Opacity" Value="0"></Setter>
                    </KeyFrame>
                    <KeyFrame Cue="100%">
                        <Setter Property="Opacity" Value="1"></Setter>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>-->
        <Style Selector="Image.bg">
            <Setter Property="Effect" Value="blur(60)"></Setter>
            <Style.Animations>
                <Animation Duration="0:0:10" IterationCount="INFINITE" PlaybackDirection="Alternate"
                           Easing="CircularEaseInOut">
                    <KeyFrame Cue="0%">
                        <Setter Property="Margin" Value="-5"></Setter>
                    </KeyFrame>
                    <KeyFrame Cue="100%">
                        <Setter Property="Margin" Value="-40"></Setter>
                    </KeyFrame>
                </Animation>
            </Style.Animations>
        </Style>

    </UserControl.Styles>

    <Panel>
        <Image Source="{Binding Cover}" Stretch="UniformToFill" Classes="bg"></Image>
        <Panel Background="Black" Opacity="0.4"></Panel>

        <Grid ColumnDefinitions="*, 1.5*" RowDefinitions="*,Auto" Margin="12, 12, 12, 0"
              RenderOptions.BitmapInterpolationMode="HighQuality">

            <StackPanel Grid.Row="0" Grid.Column="1" Orientation="Vertical" HorizontalAlignment="Right">
                <Image Source="avares://StreamerScreen/Assets/display_roon_icon.png" Height="30"
                       HorizontalAlignment="Right">
                </Image>
                <TextBlock Text="{Binding Zone}" Classes="h3" />
            </StackPanel>


            <Image Grid.Row="0" Grid.Column="0" Source="{Binding Cover}" MaxWidth="800"></Image>

            <Panel Grid.Row="0" Grid.Column="1" Margin="12,0, 0, 0" VerticalAlignment="Center" Name="TrackInfoPanel">
                <StackPanel Orientation="Vertical">
                    <ScrollViewer AllowAutoHide="True" HorizontalScrollBarVisibility="Hidden"
                                  VerticalScrollBarVisibility="Disabled" Name="TrackScrollViewer">
                        <TextBlock Text="{Binding Track}" Name="TrackTextBlock" Classes="h1" HorizontalAlignment="Left"
                                   SizeChanged="TrackTextBlock_OnSizeChanged" />
                    </ScrollViewer>

                    <TextBlock Text="{Binding Album}" Classes="h2" HorizontalAlignment="Left"
                               TextTrimming="CharacterEllipsis" />
                    <TextBlock Text="{Binding Artist}" Classes="h2" HorizontalAlignment="Left"
                               TextTrimming="CharacterEllipsis" />

                </StackPanel>
            </Panel>

            <ProgressBar Grid.Row="1" Grid.Column="0" Grid.ColumnSpan="2" Margin="-12,0"
                         Maximum="{Binding TotalSeconds}"
                         Value="{Binding ActualSeconds}"
                         Background="Transparent" Foreground="{Binding ProgressColor}" Height="10" />
        </Grid>
    </Panel>
</UserControl>